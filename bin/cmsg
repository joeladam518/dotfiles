#!/usr/bin/env bash

# Color
RESET="\033[0m"
BOLD="\033[1m"
RED="38;5;1"
GREEN="38;5;2"
YELLOW="38;5;3"
BLUE="38;5;4"
MAGENTA="38;5;5"
CYAN="38;5;6"
GRAY="38;5;240"
WHITE="38;5;7"

# Options
CHOSEN_COLOR=""
NO_NEWLINE="0"
IS_BOLD="0"
OPTIND=1

## Functions
usage()
{
    echo "Usage: $(basename "${0}") [options] [message]"
    echo ""
    echo "Adds color to your output."
    echo ""
    echo "Options:"
    echo "  -n  no newline"
    echo "  -d  bold the message"
    echo "  -r  color message red"
    echo "  -g  color message green"
    echo "  -b  color message blue"
    echo "  -c  color message cyan"
    echo "  -y  color message yellow"
    echo "  -m  color message magenta"
    echo "  -a  color message gray"
    echo "  -w  color message white"
}

invalid_option() {
    echo "Invalid option -- '-${1}'" 1>&2
    echo ""
    usage
    exit 1
}

# parse args
while getopts ":hndrgbcmyaw" opt; do
    case "$opt" in
        h) usage; exit             ;; # print help
        n) NO_NEWLINE="1"          ;; # no new line
        d) IS_BOLD="1"             ;; # make it bold
        r) CHOSEN_COLOR="$RED"     ;;
        g) CHOSEN_COLOR="$GREEN"   ;;
        b) CHOSEN_COLOR="$BLUE"    ;;
        c) CHOSEN_COLOR="$CYAN"    ;;
        m) CHOSEN_COLOR="$MAGENTA" ;;
        y) CHOSEN_COLOR="$YELLOW"  ;;
        a) CHOSEN_COLOR="$GRAY"    ;;
        w) CHOSEN_COLOR="$WHITE"   ;;
        \?) invalid_option "${OPTARG}" ;;
    esac
done

shift $((OPTIND-1))

INPUT="$*"
CMD="echo -e"

# add -n flag if we want no new line
if [ "$NO_NEWLINE" == "1" ]; then
    CMD="${CMD}n"
fi

if [ -n "$CHOSEN_COLOR" ]; then
    COLOR_SEQUENCE="\033["

    if [ "$IS_BOLD" == "1" ]; then
        COLOR_SEQUENCE="${COLOR_SEQUENCE}1;"
    fi

    COLOR_SEQUENCE="${COLOR_SEQUENCE}${CHOSEN_COLOR}m"

    $CMD "${COLOR_SEQUENCE}${INPUT}${RESET}"
else
    if [ "$IS_BOLD" == "1" ]; then
        $CMD "${BOLD}${INPUT}${RESET}"
    else
        $CMD "${INPUT}${RESET}"
    fi
fi
